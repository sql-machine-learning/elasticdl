ARG BASE_IMAGE=tensorflow/tensorflow:2.0.0b0-py3
# Use tensorflow/tensorflow:2.0.0b0-gpu-py3 if you want GPU-support.
FROM ${BASE_IMAGE}

# Replace the Splash screen from TensorFlow image.
COPY elasticdl/docker/bashrc /etc/bash.bashrc
RUN chmod a+rwx /etc/bash.bashrc

RUN apt-get update && apt-get install -y unzip curl git

ARG EXTRA_PYPI_INDEX
RUN pip install grpcio-tools kubernetes docker pytest 'pyrecordio>=0.0.6' pre-commit Pillow \
	--extra-index-url=${EXTRA_PYPI_INDEX}

# This is a hachy fix to allow pre-commit to cache downloaded hooks.
RUN mkdir /.cache
RUN chmod a+rwx /.cache
